---
title: C# 封装
article: false
date: 2023-04-15 15:02:45
permalink: /pages/34b337/
---


## 应用场景
### 防止误操作

封装可以防止用户误操作数据，保护数据的完整性。例如，在一个银行账户类中，如果将账户余额设置为 public，用户就可以直接修改其余额，这显然是不合理的。但如果将其余额设置为 private，同时提供一个公开的 `Deposit()` 方法和 `Withdraw()` 方法，用户就只能通过这些方法来修改其余额，从而保证了数据的安全性。
### 简化接口

封装可以简化接口，使用户更易于使用。例如，在一个汽车类中，如果将引擎、轮胎等组件全部暴露给用户，用户需要了解所有这些组件的细节才能正确地操作汽车。但如果将这些组件封装起来，只提供一个公开的 `Start()` 方法和 `Stop()` 方法，用户就只需要知道如何启动和停止汽车，而不必了解具体的实现细节。
### 提高代码复用性

封装可以提高代码复用性，使代码更加模块化。例如，在一个图形类中，如果将绘制图形的具体实现和数据结构都封装在类内部，可以使其它代码更易于调用该类的功能，从而提高代码的复用性。
## 技巧
### 使用属性而非公开的成员变量

尽管 C# 中允许将成员变量定义为 public，但这种做法可能会导致数据被误操作或直接修改，因此不推荐使用。相反，我们应该使用属性来管理成员变量，从而更好地控制其访问权限。
### 使用构造函数初始化对象状态

封装不仅限于成员变量和方法，还可以包括对象的状态。在类中，我们可以使用构造函数来初始化对象的状态，从而确保对象的一致性和正确性。例如，在一个日期类中，可以在构造函数中初始化对象的年、月、日等状态，以确保日期的合法性。
### 使用接口提高封装性

接口是一种可以提高封装性的机制。在一个类中，如果定义了多个公开的方法，可能会导致代码过于冗长，难以维护。此时，我们可以将这些方法抽象为接口，将接口定义为类的成员变量，从而使代码更加模块化和易于维护。

## 概念

封装是一种将数据和方法包装在一个单元中的机制。C# 中封装主要通过类来实现。在类中，我们可以将成员变量和成员函数定义为 public、private 或 protected，从而对外部用户隐藏内部实现的细节，达到保护数据和提高代码复用的目的。
## 访问修饰符

在 C# 中，有以下访问修饰符： 
- `public`：公开的，可被其他类访问。 
- `private`：私有的，只能在当前类中访问。 
- `protected`：受保护的，只能在当前类及其子类中访问。 
- `internal`：内部的，只能在当前程序集中访问。 
- `protected internal`：既是 protected，又是 internal。
## 封装实例

下面是一个简单的 C# 类示例，展示了封装的用法：

```csharp

class Person
{
    private string name;  // 私有成员变量
    private int age;

    public string Name  // 公开的成员属性
    {
        get { return name; }
        set { name = value; }
    }

    public int Age
    {
        get { return age; }
        set { age = value; }
    }

    public void ShowInfo()  // 公开的成员方法
    {
        Console.WriteLine("Name: {0}, Age: {1}", name, age);
    }
}
```



在这个类中，我们将 `name` 和 `age` 定义为私有成员变量，这意味着它们只能在类内部访问。但我们提供了公开的 `Name` 和 `Age` 属性，用于获取和设置这两个变量的值。同时，我们还提供了一个公开的 `ShowInfo()` 方法，用于输出该对象的信息。

下面是如何使用这个类的示例：

```csharp

Person p = new Person();
p.Name = "Tom";
p.Age = 18;
p.ShowInfo();  // 输出：Name: Tom, Age: 18
```



在这个示例中，我们创建了一个 `Person` 类的对象 `p`，并通过公开的属性 `Name` 和 `Age` 分别设置了其名称和年龄。最后，我们调用了 `ShowInfo()` 方法，输出该对象的信息。
## 总结

封装是一种重要的编程机制，它可以保护数据和提高代码复用。在 C# 中，封装主要通过类和访问修饰符来实现。我们可以将成员变量和成员函数定义为 public、private 或 protected，从而对外部用户隐藏内部实现的细节。
